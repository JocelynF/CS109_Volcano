      SUBROUTINE TIDAL(sjd, dlat, dlon)
	  
	  
	  IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      IMPLICIT INTEGER (I-N)
      LOGICAL VARY
c      sjd=2452262.5  
c      dlat=53.2069
c      dlon=-0.469833
      pbot=0.000 
      ptop=1.d10       
      fact=0.609/9.80
      vary=.false.   
      do i=1,3001
       djd=sjd+(i-1)/100.
       CALL TIDPOT (DLAT,DLON,DJD,PBOT,PTOP,
     .                  V2L,V2D,V2S,V3L,V3D,V3S,V3T,VARY)
       vvv=(v2l-v2d+v2s)*fact
c      vvv=(v3l-v3d+v3s-v3t)*fact
c      write(6,999) djd,v2l*fact,-v2d*fact,v2s*fact,vvv     
c999   format(f18.6,3x,f12.6,1x,f12.6,1x,f12.6,1x,f12.6)
       write(6,998) djd,v3l*fact,-v3d*fact,v3s*fact,-v3t*fact,vvv     
 998   format(f18.6,3x,f12.6,1x,f12.6,1x,f12.6,1x,f12.6,1x,f12.6)
       enddo
      END subroutine tidal
      SUBROUTINE TIDPOT (DLAT,DLON,DJD,PBOT,PTOP,
     .                  V2L,V2D,V2S,V3L,V3D,V3S,V3T,VARY)
C
C  THIS SUBROUTINE IS AN IMPLEMENTATION OF THE TIDE-GENERATING
C  POTENTIAL AS GIVEN BY CARTWRIGHT AND TAYLER (GEOPHYS. J R. ASTR SOC,
C  1971,23,45-74) AS CORRECTED BY CARTWRIGHT AND EDDEN(GEOPHYS. J. R.
C  ASTR SOC.,1973,33,253-264)
C
C  Modified by J. X. Mitrovica 4/1992
C   The core of this routine was provided by Richard Ray            
C   Unlike tidpot.f this routine is referenced to a new span
C   whose centre is at 2447161.5 (Midnight Jan 0-1, 1988)
C
C INPUT:
C GIVEN LATITUDE, LONGITUDE, AND TIME (GMT) IN JULIAN DAYS
C LATITUDE IS POSITIVE NORTH  (DLAT IN DEGREES)
C LONGITUDE IS POSITIVE EAST  (DLON IN DEGREES)
C
C OUTPUT:
C SUBROUTINE WILL RETURN SECOND AND THIRD DEGREE POTENTIAL VALUES IN
C MKS SYSTEM
C     V2L       DEGREE 2, LONG TERM TIDES       (2,0 COMP.)
C     V2D       DEGREE 2, DIURNAL TIDES         (2,1 COMP.)
C     V2S       DEGREE 2, SEMI-DIURNAL TIDES    (2,2 COMP.)
C     V3L       DEGREE 3, LONG TERM TIDES       (3,0 COMP.)
C     V3D       DEGREE 3, DIURNAL TIDES         (3,1 COMP.)
C     V3S       DEGREE 3, SEMI-DIURNAL TIDES    (3,2 COMP.)
C     V3T       DEGREE 3, TER-DIURNAL TIDES     (3,3 COMP.)
C
C *VARY*
C   THE FIRST TERM IN THE SECOND DEGREE SERIES IS A ZERO FREQUENCY
C (CONSTANT) TERM USUALLY CALL THE LUNAR AND SOLAR FLATTENING(IT IS
C MULTIPLIED BY P20). IF THIS TERM IS TO BE INCLUDED , THE LOGICAL*4
C PARAMETER 'VARY' SHOULD BE SET TRUE; IF NOT, FALSE.
C
C  Note: NOAA's earth tide for Geosat processing is computed by
C  calling this subroutine, then setting
C   earth tide = ((.619*V2 + .291*V3)/9.78)*1000.     -RDR
C
C
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      IMPLICIT INTEGER (I-N)
      LOGICAL VARY
      INTEGER           K2(486),K3(486),K4(486),K5(486),K6(486)
      INTEGER   K41(242),K42(244)
      INTEGER   K51(242),K52(244)
      REAL   CS1(136),CS2(120),CS3(128),CS4(102),CS(486)
      DIMENSION FR(6),PHIR(6)
      EQUIVALENCE (CS1(1),CS(1)),(CS2(1),CS(137))
      EQUIVALENCE(CS3(1),CS(257)),(CS4(1),CS(385))
      EQUIVALENCE (K4(1),K41(1)),(K4(243),K42(1))
      EQUIVALENCE (K5(1),K51(1)),(K5(243),K52(1))
C TIME IN JD OF MIDNIGHT JAN 0-1, 1988
      DATA D1988/2447161.5D0/
C THE FOLLOWING IN REVS PER DAY
C     DATA FR/0.D0,.0366011021D0,.0027379092D0,.0003094543D0,
C    .  .000147094D0,.0000001308D0/
C THE FOLLOWING IN RADIANS PER DAY
      DATA FR/0.D0,.2299715070D0,.0172027908D0,1.944358962D-3,
     .  9.2421838D-4,8.2184063D-7/
C THE FOLLOWING IN DEGREES
C     DATA PHIR/400.283088D0,59.5962231,279.8793D0,315.01949D0,
C    .  2.8338719D0,282.73418D0/
C THE FOLLOWING IN RADIANS
      DATA PHIR/6.986257826D0,1.040150314D0,4.884815480D0,
     .  5.498127254D0,.0494603950D0,4.934642281D0/
      DATA PI/3.141592653589793D0/
      DATA TWOPI/6.283185307179586D0/
      DATA DTR/.01745329251993D0/
      DATA GRAV/9.80D0/
      DATA CS1/
     .-.31455,0.0279223,-.00028,0.00004,-.00004,-.0049123,0.00026,
     .  0.00005,
     .  0.00002,-.0003277,-.0309847,-.0001123,0.00077,0.00017,-.00181,
     .  0.00003,
     .  -.00007,0.00002,-.00029,0.00002,0.00000,0.00007,0.00048,-.00673,
     .  0.00044,0.00000,-.00022,0.00020,0.00005,-.00003,0.00231,-.03518,
     .  0.0022977,0.00188,0.00077,0.00021,0.00018,0.00049,0.0002323,
     .  0.00004,
     .  0.00002,-.00011,-.0003723,0.00002,-.00042,-.00583,0.0003877,
     .  0.00004,
     .  -.00004,0.00003,0.00006,-.00020,-.00004,0.00015,-.00288,0.00019,
     .  -.06661466,-.02762,-.00258,0.00006,0.00003,0.00023,0.00006,
     .  0.00020,
     .  0.00008,0.00003,-.00002,-.00017,-.00007,-.00011,-.00004,-.00009,
     .  -.00092,0.00006,-.00242,-.00100,-.00009,-.00013,-.00004,0.00007,
     .  0.00003,0.0000377,-.00023,0.00004,0.00004,-.01276,-.00529,
     .  -.0005177,
     .  0.00005,0.00002,0.00011,0.00004,-.00008,-.00006,-.00003,-.00014,
     .  -.00006,-.00011,-.00204,-.00084,-.00008,-.00003,0.00003,-.00169,
     .  -.00070,-.0000776,-.00014,-.00075,0.00004,-.00037,-.00194,
     .  -.00015,
     .  -.00007,-.00037,-.00004,0.00009,0.00004,0.00002,-.00125,-.00664,
     .  0.00011,0.00007,-.00010,0.00003,-.00151,-.00802,0.00007,-.00010,
     .  -.00054,-.00005,-.00024,0.00008,-.00003,0.00004,0.00016,0.00007/
      DATA CS2/
     .  0.00042,0.00004,0.00019,0.00029,-.00004,-.00947,-.05019,0.00014,
     .  0.00009,0.00005,0.00027,-.00008,-.00046,0.00005,-.00180,-.00954,
     .  0.00055,-.00017,-.00008,-.00044,0.00004,0.00012,0.00011,0.00014,
     .  0.00079,0.00011,0.00090,-.00004,0.00152,-.04945,-.26217,-.00005,
     .  0.00170,0.00028,-.00008,-.00076,0.00015,-.00010,0.00343,-.00075,
     .  -.00005,0.00023,0.00006,0.00009,0.00044,0.00194,-.00004,-.00010,
     .  -.00012,0.00137,0.00740,-.00058,0.02061,0.00414,-.00010,-.00012,
     .  0.00013,-.00011,0.00393,0.00087,0.00017,0.00004,-.00029,0.00006,
     .  -.00713,-.00010,0.00137,-.12201,0.00005,0.00017,0.00004,0.00101,
     .  0.00289,-.00008,0.00007,0.00006,-.00729,0.36874,0.05001,-.00108,
     .  0.00293,0.00005,0.00018,0.00005,0.00007,0.00525,-.00020,-.00010,
     .  0.00031,0.00017,0.00012,-.00011,0.00396,0.00078,0.00012,-.00013,
     .  -.00059,0.02062,0.00409,-.00005,-.00032,-.00020,-.00012,-.00012,
     .  -.00008,-.00006,0.00006,0.00023,0.00004,0.00011,0.00342,0.00067,
     .  -.00007,-.00004,0.00169,0.00034,0.01129,0.00723,0.00151,0.00010/
      DATA CS3/
     .  -.00004,0.00010,0.00004,0.00054,0.00011,0.00041,0.00026,0.00005,
     .  0.00013,0.00216,0.00138,0.00029,0.00019,0.00078,0.00006,0.00048,
     .  0.00006,-.00007,0.00180,-.00009,0.00004,-.00017,0.00467,0.00036,
     .  -.00003,0.00090,0.00010,-.00006,-.00022,-.00010,-.00060,0.01601,
     .  -.00027,-.00017,0.00025,-.00072,0.01932,-.0000323,-.00005,
     .  0.0012923,
     .  0.00059,0.00005,0.00005,-.00010,-.00039,0.00003,-.00102,-.00047,
     .  0.0000777,0.0001077,-.00451,0.1209977,-.00022,-.00065,-.00004,
     .  0.00113,
     .  -.00086,0.02298,0.00010,-.00008,-.00004,0.00106,-.00008,
     .  -.0002877,
     .  0.00007,-.00190,0.00005,-.00218,0.00009,0.00033,-.0235723,
     .  0.6319353,
     .  0.00037,0.00013,-.00004,0.00192,-.00036,0.00072,-.00036,0.00012,
     .  0.00005,-.00022,0.00021,-.00466,-.00007,0.00011,0.0006677,
     .  -.01786,
     .  -.00008,0.00447,0.00197,0.00028,0.0008677,0.00041,0.00005,
     .  0.00070,
     .  0.0171847,0.00066,0.2940153,0.00004,-.00246,0.00062,-.00004,
     .  -.00102,
     .  0.079937,0.02383,0.00259,0.00063,0.00004,0.00053,0.00004,
     .  0.00006,
     .  0.00004,0.00086,0.00037,0.00004,-.00009,0.00447,0.00195,
     .  0.0002277,
     .  -.00003,0.00005,0.00074,0.00032,0.00003,0.00037,0.00016,0.00117/
      DATA CS4/
     .  0.0010023,0.00033,0.00005,-.00021,-.00004,0.00004,0.0001823,
     .  -.00375,
     .  -.00059,0.00005,-.00012,-.00061,-.00010,-.00010,-.00007,-.00030,
     .  -.00019,-.00004,-.00008,-.00005,-.00006,-.00006,-.00014,-.00035,
     .  -.00007,-.00004,-.00050,-.00128,-.00008,-.00011,0.00007,0.00010,
     .  -.00065,0.0000977,-.00013,0.00059,-.00399,0.00052,-.00004,
     .  0.00003,
     .  -.00022,0.00003,-.00008,-.00003,-.00005,0.00005,-.00146,-.00059,
     .  -.00005,-.00005,-.00024,-.00010,-.00004,-.00005,-.00005,-.00006,
     .  -.00018,-.00003,-.00018,-.00018,-.00107,-.00003,-.00020,
     .  0.0000223,
     .  -.00066,-.00389,0.00007,0.00010,0.00005,0.00004,0.00022,-.00003,
     .  0.00059,0.00011,0.00011,-.00021,0.00359,0.00068,0.00004,0.00019,
     .  0.00004,0.00004,0.00033,0.00021,0.00004,0.00005,0.00037,0.00037,
     .  -.00012,0.00210,0.00039,-.00005,-.0004223,0.00765,-.00011,
     .  -.00043,
     .  0.00016,0.00007,-.00004,0.00100,0.00043,0.00005/
C     DATA K1/106*0,162*1,119*2,17*0,35*1,31*2,16*3/
      DATA K2/
     .  17*0,24*1,25*2,26*3,14*4,9*-4,18*-3,26*-2,20*-1,19*0,27*1,
     .  17*2,15*3,11*4,5*-4,10*-3,16*-2,19*-1,19*0,14*1,15*2,11*3,
     .  10*4,2*0,5*1,3*2,5*3,2*4,2*-4,3*-3,5*-2,5*-1,3*0,6*1,5*2,3*3,
     .  3*4,-4,3*-3,4*-2,5*-1,7*0,3*1,3*2,4*3,4,2*-2,3*-1,3*0,4*1,4*2/
      DATA K3/4*0,4*1,6*2,2*3,4,3*-3,5*-2,4*-1,7*0,1,3*2,3,-4,2*-3,4*-2,
     .  5*-1,7*0,3*1,3*2,-5,-4,3*-3,6*-2,5*-1,6*0,
     . 0, 0, 1, 1,-4,-4,-4,-3,-3,-2,-2,-2,-2,-1,-1, 0, 0, 0, 0, 0, 1, 2,
     . 2, 3, 4, 4, 5,-1, 0, 0, 0, 0, 1, 1, 1, 2, 2, 2, 2, 3, 3, 4, 4, 4,
     . 4,-2,-2,-1,-1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2,
     . 3, 3, 3, 4,-2,-2,-2,-1,-1,-1, 0, 0, 0, 0, 0, 0, 1, 1, 2, 2, 2, 2,
     . 2, 3, 4,-3,-2,-2,-1,-1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 2, 2, 2, 3, 3,
     .-4,-3,-3,-2,-2,-2,-2,-2,-2,-1,-1,-1, 0, 0, 0, 0, 0, 0, 1, 1, 2, 2,
     . 2, 2, 2, 2, 3,-3,-2,-2,-2,-2,-1,-1, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2,
     .-4,-3,-3,-2,-2,-2,-1, 0, 0, 0, 0, 0, 0, 0, 1,-4,-3,-2,-2,-2,-2,-2,
     . 0, 0, 0, 0, 0, 2, 3, 4, 5, 0, 0, 1, 1, 2, 2, 3, 4, 4, 5,-2,-1, 0,
     . 0, 0, 1, 1, 1, 2, 2, 3, 3, 3, 4, 4, 5,-2,-2,-1,-1, 0, 0, 0, 0, 0,
     . 1, 1, 1, 1, 2, 2, 2, 2, 3, 3,-3,-2,-2,-2,-1,-1,-1, 0, 0, 0, 0, 0,
     . 1, 1, 2, 2, 2, 2, 3,-3,-2,-2,-1,-1, 0, 0, 0, 0, 0, 0, 2, 2, 2,-4,
     .-3,-2,-2,-2,-1,-1,-1, 0, 0, 0, 0, 1, 2, 2,-3,-2,-2,-2,-2,-2, 0, 0,
     . 0, 0, 0,-3,-2,-2,-2, 0, 0, 0, 0, 0, 0, 0, 2,-2, 0, 0, 0, 0,-2, 0,
     . 0,-2, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 2, 0, 0, 0, 0, 2, 0, 0, 0, 0,
     . 2, 0, 0, 0,-2, 0, 0, 0, 0, 0,-2, 0, 0, 0, 0,-2, 0, 0,-2, 0, 0, 2,
     . 0, 2, 2, 0, 0, 2, 2, 0, 0, 0, 0, 2,-2, 0, 0, 0, 0, 0, 2, 0, 0, 0,
     .  -2,2*0,-2,5*0,2,2*0,2,-2,2*0,-2,7*0/
      DATA K41/
     . 0, 0, 0, 2, 0, 0, 0, 0,-2,-2, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1,-1,-1,
     . 1, 1, 1,-1,-1, 0, 1,-1,-1,-1,-1, 1, 1, 1,-1,-1,-1,-1,-1, 2, 0, 0,
     . 0, 0, 0, 2,-2,-1, 0, 0, 0,-2,-2,-2, 0, 0, 0, 0,-2, 0, 0,-2,-2, 0,
     . 1, 1,-1, 1, 1,-1,-1,-1, 1, 1, 1,-1,-1, 0, 0, 1,-3,-3,-3,-1,-1,-1,
     . 1, 1,-1,-1, 0, 2, 2, 0, 0,-2, 0, 0, 0,-2, 0,-2,-2,-2, 3, 3, 1, 1,
     . 1, 1,-1,-1,-1, 2, 0, 2, 2, 2, 0, 1, 2, 0, 0, 0, 2, 0, 0,-2,-2, 0,
     . 0, 1, 3, 1, 1,-1,-1, 1, 0, 1, 1, 3,-1, 0, 0, 1, 1,-1,-1,-1, 1, 1,
     .-1,-1, 1,-1, 0, 2, 2, 0, 0, 1, 0, 0, 0, 2, 2, 2, 0, 0,-2, 0, 0, 0,
     . 0, 0,-2, 1, 1, 1, 0, 1,-1,-1,-1, 1, 1, 1, 1, 0, 1,-1,-1,-1,-1,-1,
     . 0, 0, 0, 0, 0, 0, 0, 2, 2, 0, 0, 0,-2, 0, 0, 0, 0, 0, 0, 0,-2,-2,
     . 0, 0, 0, 0, 0, 1,-1, 1, 1, 1,-1, 0,-1,-1,-1,-1, 1, 1, 1,-1,-1,-1/
      DATA K42/
     . 2, 0, 0, 0, 0, 0, 0,-2,-2,-2, 0, 0, 0, 0, 0, 1,-1,-1,-1, 1, 1, 1,
     .-3,-1,-1,-1, 4, 2, 2, 0, 0, 3, 3, 1, 3, 1, 1, 1,-1,-1,-1, 4, 2, 0,
     . 2, 2, 0, 1, 2, 0, 0,-1, 0, 0,-2, 0,-2, 1, 3, 1, 1,-1, 1, 0, 1, 1,
     .-1, 0, 1, 1,-1,-1, 1, 1,-1,-1, 2, 0, 2, 2, 0, 0, 1, 0, 0, 0, 2, 2,
     . 0, 0,-2, 0, 0, 0, 0, 1, 1, 1,-1, 0,-1,-1, 1, 1, 1, 1,-1,-1,-1, 0,
     . 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0,-2, 0, 1,-1,-1, 1, 1, 1,-1,-1,
     .-1,-1, 1, 0, 0, 0, 0,-2,-2, 0, 0, 0, 0, 1,-1, 0, 0, 0, 0, 0, 1,-1,
     .-1, 0,-2, 0, 0, 0,-1,-1, 2, 0, 1, 1,-1, 0, 0, 0, 2, 0,-1, 1, 1, 1,
     .-1, 0, 0, 0, 1,-1,-1,-1, 1, 1, 0, 0, 0, 0, 0, 1,-1,-1, 0, 0, 0, 1,
     . 2, 0, 0, 1, 1,-1,-1, 0, 0, 0, 2, 0, 1,-1,-1, 1, 1, 1,-1, 0, 0, 0,
     . 1,-1,-1, 0, 0, 0, 0,-1, 2, 0, 1, 1,-1, 2, 0, 0, 1,-1, 1, 1,4*0/
      DATA K51/
     . 0, 1, 2, 1,-1, 0, 0, 1,-1, 0, 0, 0, 1, 2, 0, 1, 0,-1, 0, 1,-2,-1,
     .-1, 0, 1,-1, 0, 0, 0,-2,-1, 0, 1, 0, 1, 2, 0, 0, 1, 2, 0, 0, 0, 1,
     .-1, 0, 1, 0, 0, 0, 0, 0, 1,-1, 0, 1, 0, 1, 2, 3, 0, 0, 1, 0, 1, 2,
     . 0, 0, 0, 0, 1,-1, 0, 1, 0, 1, 2, 0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 2,
     . 2, 3, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 2, 0, 0, 0, 1, 2,-1, 0, 0,-1,
     . 0, 0,-1, 0, 0, 0,-2,-2,-1, 0, 0, 0, 0,-2,-1, 0, 0,-1, 0,-1, 0, 0,
     . 1,-2, 0,-1, 0,-3,-2,-2, 0,-1, 0, 0, 0,-1, 0,-1, 0,-2,-1, 0, 0, 1,
     .-1, 0, 0, 0,-2,-1, 0,-1, 0, 0,-2,-1, 0,-1, 0, 1,-1, 0, 0,-1, 0, 1,
     . 2, 0, 0, 0,-1, 0, 0, 0,-2,-1, 0,-1, 0, 1, 2, 0, 0,-1, 0, 1, 0, 1,
     . 0,-1, 0,-2,-1, 0, 0, 0, 1, 0, 0, 1,-1,-2,-1, 0, 1, 2, 0, 1, 0, 1,
     . 0, 0, 1, 2, 0, 0,-1,-1, 0, 1, 0, 0,-1, 0, 1, 2, 0, 1, 2, 0, 0, 1/
      DATA K52/
     . 0, 0, 1,-1, 0, 1, 0,-1, 0, 1, 0, 1, 2, 3, 0, 0, 0, 0, 1, 0, 1, 2,
     . 0, 0, 1, 2, 0, 0, 0, 0, 0,-1, 0, 0, 0,-1, 0, 0,-1, 0, 0, 0, 0,-2,
     .-1, 0, 0, 0, 0,-1, 0, 0,-1, 0, 0, 0, 0,-2, 0,-1, 0,-2,-2, 0,-1, 0,
     . 0, 0,-1, 0,-1, 0, 0, 1,-1, 0, 0,-2,-1, 0,-1, 0, 0,-2,-1, 0, 0, 1,
     .-1, 0, 0, 0, 1, 2, 0, 0,-1, 0, 0, 0,-1, 0,-1, 0, 1, 2, 0, 1, 2, 0,
     . 0,-1, 0, 0, 0, 0, 1,-1, 0, 1, 2, 0, 0, 0, 0,-1, 0, 0, 1, 2,-1, 0,
     . 1, 2, 0, 0, 0, 1, 2, 0, 1, 0, 1, 2, 3, 0, 0, 0,-1, 0, 1, 2, 0, 0,
     . 1, 0, 0, 0, 1, 2, 0, 1, 0, 0,-1, 0, 0,-2,-1, 0, 0, 0, 0,-1, 0, 1,
     . 0,-1, 0, 1, 0,-1, 0, 1, 0, 1, 0,-1, 0, 1, 2, 0, 0, 1, 0, 0, 1, 0,
     . 0,-1, 0,-1, 0,-1, 0,-2,-1, 0, 0, 0, 0,-1, 0,-1, 0, 1, 0,-1, 0, 1,
     . 0, 0, 1, 0, 0, 1, 2, 0, 0, 0,-1, 0, 0, 0,-1, 0, 0, 0, 0, 1,-1, 0,
     .  1,2/
      DATA K6/
     . 0, 0, 0, 0,-1,-1, 1,-1, 0, 0, 0,-2, 0, 0,-1,-1,-2, 1, 1, 1, 0, 0,
     . 0, 0, 0, 1, 1, 0,-1, 0, 0, 0, 0, 0, 0, 0,-1, 0, 0, 0,-1, 0, 1, 1,
     . 0, 0, 0, 0, 1, 0,-1, 1, 1, 0, 0, 0, 0, 0, 0, 0,-1,-1,-1, 0, 0, 0,
     . 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0,-1, 0,-1, 1, 0, 0, 0,
     . 0, 0,-1,-1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1,-1, 0, 0, 0, 0, 0, 1, 0,
     . 0,-1, 0, 0,-1, 1, 0, 0, 0, 0, 1, 0,-1, 0, 0, 0, 0,-1,-1, 0, 0, 0,
     . 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0,-1,-1, 0, 0, 0, 0, 0,
     .-1,-1,-1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0,-1,-1, 0, 0, 0, 0,
     . 0,-1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0,-1, 0, 0, 0,-1,-1,
     . 2, 1, 1, 0, 0, 0, 2, 0, 0,-1, 1, 1, 0, 0, 0, 0, 0, 0,-1,-1, 0, 0,
     .-2, 0, 0, 0,-1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0,-1, 0, 0,
     . 0, 1, 1, 0, 0, 0,-1, 0, 0, 0, 0, 0, 0, 0,-1, 0, 1, 0, 0, 0, 0, 0,
     . 0, 0, 0, 0, 0, 0,-1, 0,-1, 0, 0, 1,-1, 0, 0,-1, 0, 0,-1, 0, 1, 0,
     . 0, 0, 1, 0,-1, 0, 0, 0,-1,-1, 0,-2,-1, 0, 0, 1, 1, 0, 0, 1, 0, 0,
     . 1, 0,-1,-1, 0, 0, 0, 0,-1,-1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0,
     .-1,-1, 0, 0, 0, 0,-1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2,
     . 1, 0, 0, 0,-1, 1, 1, 0, 0, 0, 0,-1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0,
     .  2*0,1,109*0/
C DONE IN TERMS OF LATITUDE RATHER THAN CO-LATITUDE
      SINTH=DSIN(DLAT*DTR)
      COSTH=DCOS(DLAT*DTR)
      RLAM=DLON*DTR
C
C COMPUTE NORMALIZED LEGENDRE FUNCTIONS  (FULLY NORMALIZED)
      W20=DSQRT(5.D0/(4.D0*PI))*(1.5D0*SINTH**2-.5D0)
      W21=-DSQRT(5.D0/(24.D0*PI))*3.D0*SINTH*COSTH
      W22=DSQRT(5.D0/(96.D0*PI))*3.D0*COSTH**2
C DERIVATIVES WRT LATITUDE
      W20LAT=DSQRT(5.D0/(4.D0*PI))*3.D0*SINTH*COSTH
      W21LAT=-DSQRT(5.D0/(24.D0*PI))*3.D0*(1.D0-2.D0*SINTH**2)
      W22LAT=-DSQRT(5.D0/(96.D0*PI))*6.D0*SINTH*COSTH
C
C DT IN DAYS
      DT=DJD-D1988
C OBTAIN INTEGER DAYS
      IDT=DT
      PDAY=DT-IDT
      ANGLE1=PDAY*TWOPI  +(FR(3)-FR(2))*DT +PHIR(1)
      ANGLE2=FR(2)*DT+PHIR(2)
      ANGLE3=FR(3)*DT+PHIR(3)
      ANGLE4=FR(4)*DT+PHIR(4)
      ANGLE5=FR(5)*DT+PHIR(5)
      ANGLE6=FR(6)*DT+PHIR(6)
      ANGLE1=DMOD(ANGLE1,TWOPI)
      ANGLE2=DMOD(ANGLE2,TWOPI)
      ANGLE3=DMOD(ANGLE3,TWOPI)
      ANGLE4=DMOD(ANGLE4,TWOPI)
      ANGLE5=DMOD(ANGLE5,TWOPI)
      ANGLE6=DMOD(ANGLE6,TWOPI)
C
      ASUM=ANGLE1+RLAM
      ASUM=DMOD(ASUM,TWOPI)
C (2,0) CONTRIBUTION
C
      V2=0.D0
      V3=0.D0
      IF(VARY)V2=CS(1)
      DO 100 I=2,106
      SFREQ=K2(I)*FR(2)+K3(I)*FR(3)+K4(I)*FR(4)+K5(I)*FR(5)+
     .  K6(I)*FR(6)
      IF(SFREQ .LT. 1.D-20) SFREQ=1.D-20
      SFREQ=TWOPI/SFREQ
      IF(SFREQ .LT. PBOT .OR. SFREQ .GT. PTOP) GO TO 100
      ALPHA=K2(I)*ANGLE2+K3(I)*ANGLE3+K4(I)*ANGLE4+K5(I)*ANGLE5+
     .  K6(I)*ANGLE6
      ALPHA=DMOD(ALPHA,TWOPI)
      V2=V2+CS(I)*DCOS(ALPHA)
  100 CONTINUE
      V2LAT=V2*W20LAT*GRAV
      V2=V2*W20*GRAV
      V2L=V2
C
C  (2,1) CONTRIBUTION
C
      V21=0.D0
      V21LON=0.D0
      DO 200 I=107,268
      ALPHA=       K2(I)*ANGLE2+K3(I)*ANGLE3+K4(I)*ANGLE4+
     .  K5(I)*ANGLE5+K6(I)*ANGLE6+ASUM
      ALPHA=DMOD(ALPHA,TWOPI)
      V21=V21+CS(I)*DSIN(ALPHA)
      V21LON=V21LON+CS(I)*DCOS(ALPHA)
  200 CONTINUE
      V2=V2+W21*V21*GRAV
      V2LON=W21*V21LON*GRAV
      V2LAT=V2LAT+W21LAT*V21*GRAV
      V2D=W21*V21*GRAV
C
C  (2,2) CONTRIBUTION
      V22=0.D0
      V22LON=0.D0
      ASUM2=ASUM+ASUM
      DO 300 I=269,387
      ALPHA=   K2(I)*ANGLE2+K3(I)*ANGLE3+K4(I)*ANGLE4+K5(I)*ANGLE5+
     .  K6(I)*ANGLE6+ASUM2
      ALPHA=DMOD(ALPHA,TWOPI)
      V22=V22+CS(I)*DCOS(ALPHA)
      V22LON=V22LON+CS(I)*DSIN(ALPHA)
  300 CONTINUE
      V2=V2+W22*V22*GRAV
      V2LAT=V2LAT+W22LAT*V22*GRAV
      V2LON=V2LON-2.D0*W22*V22LON*GRAV
      V2S=W22*V22*GRAV
C
C COMPUTE NORMALIZED LEGENDRE FUNCTIONS  (FULLY NORMALIZED)
      W30=DSQRT(7.D0/(4.D0*PI))*(2.5D0*SINTH**2-1.5D0)*SINTH
      W31=-DSQRT(7.D0/(48.D0*PI))*1.5D0*COSTH*(5.D0*SINTH**2-1.D0)
      W32=DSQRT(7.D0/(480.D0*PI))*15.D0*COSTH**2*SINTH
      W33=-DSQRT(7.D0/(2880.D0*PI))*15.D0*COSTH**3
C DERIVATIVES WRT LATITUDE
      W30LAT=DSQRT(7.D0/(4.D0*PI))*(7.5D0*SINTH**2-1.5D0)*COSTH
      W31LAT=-DSQRT(7.D0/(48.D0*PI))*1.5D0*(10.D0*COSTH**2-
     . 5.D0*SINTH**2+1.D0)*SINTH
      W32LAT=DSQRT(7.D0/(480.D0*PI))*15.D0*(1.D0-3.D0*SINTH**2)*COSTH
      W33LAT=DSQRT(7.D0/(2880.D0*PI))*45.D0*COSTH**2*SINTH
C
C
C  (3,0) CONTRIBUTION
C
      V30=0.D0
      DO 500 I=388,404
      ALPHA=K2(I)*ANGLE2+K3(I)*ANGLE3+K4(I)*ANGLE4+K5(I)*ANGLE5+
     .  K6(I)*ANGLE6
      ALPHA=DMOD(ALPHA,TWOPI)
      V30=V30+CS(I)*DSIN(ALPHA)
  500 CONTINUE
      V3=V3+W30*V30*GRAV
      V3LAT=W30LAT*V30*GRAV
      V3L=W30*V30*GRAV 
C 
C  (3,1) CONTRIBUTION
C
      V31=0.D0
      V31LON=0.D0
      DO 600 I=405,439
      ALPHA=K2(I)*ANGLE2+K3(I)*ANGLE3+K4(I)*ANGLE4+K5(I)*ANGLE5+
     .  K6(I)*ANGLE6+ASUM
      ALPHA=DMOD(ALPHA,TWOPI)
      V31=V31+CS(I)*DCOS(ALPHA)
      V31LON=V31LON+CS(I)*DSIN(ALPHA)
  600 CONTINUE
      V3=V3+W31*V31*GRAV
      V3LAT=V3LAT+W31LAT*V31*GRAV
      V3LON=-W31*V31LON*GRAV
      V3D=W31*V31*GRAV 
C
C  (3,2) CONTRIBUTION
C
      V32=0.D0
      V32LON=0.D0
      DO 700 I=440,470
      ALPHA=K2(I)*ANGLE2+K3(I)*ANGLE3+K4(I)*ANGLE4+K5(I)*ANGLE5+
     .  K6(I)*ANGLE6+ASUM2
      ALPHA=DMOD(ALPHA,TWOPI)
      V32=V32+CS(I)*DSIN(ALPHA)
      V32LON=V32LON+CS(I)*DCOS(ALPHA)
  700 CONTINUE
      V3=V3+W32*V32*GRAV
      V3LAT=V3LAT+W32LAT*V32*GRAV
      V3LON=V3LON+W32*V32LON*2.D0*GRAV
      V3S=W32*V32*GRAV
C
C  (3,3) CONTRIBUTION
C
      ASUM3=ASUM+ASUM2
      V33=0.D0
      V33LON=0.D0
      DO 800 I=471,486
      ALPHA=K2(I)*ANGLE2+K3(I)*ANGLE3+K4(I)*ANGLE4+K5(I)*ANGLE5+
     .  K6(I)*ANGLE6+ASUM3
      ALPHA=DMOD(ALPHA,TWOPI)
      V33=V33+CS(I)*DCOS(ALPHA)
      V33LON=V33LON+CS(I)*DSIN(ALPHA)
  800 CONTINUE
      V3=V3+W33*V33*GRAV
      V3LAT=V3LAT+W33LAT*V33*GRAV
      V3LON=V3LON-W33*V33LON*3.D0*GRAV
      V3T=W33*V33*GRAV
C     DG2=-1.16*2.D0*V2/6378160.D0*1.D+5
C     DG3=-3.D0*V3/6378160.D0*1.D+5     *1.07D0
      DG=-1.D+5*(1.16D0*2.D0*V2+1.07D0*3.D0*V3)/6378160.D0
C     DG=-1.D+5*(2.D0*(V2ZERO+1.16D00*V2)+1.07D0*3.D0*V3)/6378160.D0
      RETURN
      END

